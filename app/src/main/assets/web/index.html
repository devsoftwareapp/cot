<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>PDF Reader</title>
<style>
    body { font-family: Arial; padding: 20px; }
    #btnPermission {
        display: block;
        width: 100%;
        padding: 14px;
        font-size: 18px;
        background: #007bff;
        color: white;
        border-radius: 8px;
        border: none;
        margin-top: 40px;
    }
    #pdfList div {
        background: #eee;
        padding: 12px;
        margin-top: 10px;
        border-radius: 6px;
    }
</style>
</head>
<body>

<h2>PDF Dosyaları</h2>

<button id="btnPermission" onclick="goPermission()">
    Tüm Dosya Erişim Ayarına Git
</button>

<div id="pdfList"></div>

<script>

// Android yeniden görününce MainActivity onResume çağırır
function onAndroidResume() {
    checkPermissionAndLoad();
}

function checkPermissionAndLoad() {
    const granted = Android.checkPermission();

    if (granted) {
        // Buton gizlensin
        document.getElementById("btnPermission").style.display = "none";

        // PDF'leri getir
        loadPDFs();
    }
}

function goPermission() {
    window.location.href = "settings://all_files";
}

function loadPDFs() {
    const data = Android.listPDFs();
    const pdfs = data.split("||");

    const container = document.getElementById("pdfList");
    container.innerHTML = "";

    if (pdfs.length === 1 && pdfs[0] === "") {
        container.innerHTML = "<p>PDF bulunamadı.</p>";
        return;
    }

    pdfs.forEach(path => {
        const div = document.createElement("div");
        div.innerText = path;
        container.appendChild(div);
    });
}

// İlk açılış
checkPermissionAndLoad();

</script>
</body>
</html>

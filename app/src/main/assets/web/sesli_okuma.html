<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sesli Okuma - PDF SeÃ§</title>
  <style>
    body{font-family:Arial,Helvetica,sans-serif;padding:18px}
    .toolbar{display:flex;gap:8px;flex-wrap:wrap}
    button{padding:10px 14px;font-size:16px;cursor:pointer}
    #status{margin-top:12px;color:#333}
  </style>
</head>
<body>
  <h2>PDF Sesli Okuyucu</h2>
  <div class="toolbar">
    <button id="btnSelect">ğŸ“„ PDF SEÃ‡</button>
    <button id="btnOpenViewer" disabled>â–¶ Viewer'da AÃ§</button>
  </div>
  <div id="status">HenÃ¼z PDF seÃ§ilmedi.</div>

  <script>
    const btnSelect = document.getElementById('btnSelect');
    const btnOpenViewer = document.getElementById('btnOpenViewer');
    const status = document.getElementById('status');

    // PDF base64 verisi burada tutulur
    let selectedBase64 = null;

    btnSelect.onclick = function() {
      if (window.Android && Android.openFilePicker) {
        Android.openFilePicker();
      } else {
        alert('Android baÄŸlantÄ±sÄ± mevcut deÄŸil. Uygulamada aÃ§Ä±n.');
      }
    };

    // Android tarafÄ± seÃ§imi tamamlayÄ±nca bu fonksiyonu Ã§aÄŸÄ±rÄ±r
    // MainActivity.onActivityResult -> evaluateJavascript("onPdfSelectedFromAndroid(base64)")
    function onPdfSelectedFromAndroid(base64) {
      if (!base64) {
        status.textContent = 'PDF alÄ±namadÄ± veya boÅŸ.';
        return;
      }

      selectedBase64 = base64;
      status.textContent = 'PDF alÄ±ndÄ± (' + Math.round(base64.length/1024) + ' KB). "Viewer\'da AÃ§" ile gÃ¶rÃ¼ntÃ¼leyin.';
      btnOpenViewer.disabled = false;
    }

    // Viewer'Ä± aÃ§ - aynÄ± dizindeki viewer.html kullanÄ±lacak
    btnOpenViewer.onclick = function() {
      if (!selectedBase64) {
        alert('Ã–nce PDF seÃ§in.');
        return;
      }

      // viewer.html'e base64 param ile yÃ¶nlendir
      // encodeURIComponent ile gÃ¶nderiyoruz
      const url = 'viewer.html?base64=' + encodeURIComponent(selectedBase64);
      // navigate same folder
      window.location.href = url;
    };

    // EÄŸer istersen JS'ten TTS Ã§aÄŸÄ±rma Ã¶rneÄŸi:
    // window.Android.speak(text, 'en-US', 1.0);

    // GÃ¼venlik: bÃ¼yÃ¼k base64'leri localStorage'a koymak performansÄ± dÃ¼ÅŸÃ¼rebilir.
    // Bu demo yÃ¶ntemiyle base64 direk query-string'e koyuluyor; eÄŸer Ã§ok bÃ¼yÃ¼kse viewer.html'e 
    // postMessage veya temp file + FileProvider kullan Ã¶nerilir.
  </script>
</body>
</html>
